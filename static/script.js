const translations = {
    ru: {
        nav_features: "Возможности",
        nav_how: "Как работает",
        nav_pricing: "Тарифы",
        nav_docs: "Документация",
        nav_blog: "Блог",
        nav_login: "Войти",
        nav_start: "Начать бесплатно",

        hero_badge: "Работает на Claude 3.5 & Gemini Flash",
        hero_title: "Ваш персональный <br><span class='gradient-text type-effect'>финансовый AI-ассистент</span>",
        hero_subtitle: "Управляйте деньгами, задачами и расписанием прямо в любимом мессенджере. Идеально для малого бизнеса, фрилансеров и семей.",
        hero_btn_start: "Начать использовать",
        hero_btn_docs: "Читать документацию",

        integrations_label: "ИНТЕГРИРУЕТСЯ С ВАШИМИ ЛЮБИМЫМИ ИНСТРУМЕНТАМИ",

        features_badge: "ПОЛНЫЙ КОНТРОЛЬ",
        features_title: "Всё, что вам нужно. <br>В <span class='gradient-text'>одном</span> чате.",
        features_subtitle: "Забудьте о сложных таблицах и десятках приложений. Просто напишите команду или отправьте фото.",

        f1_title: "Smart OCR чеков",
        f1_desc: "Умное извлечение данных. Отправьте фото скомканного чека. AI мгновенно распознает мерчанта, товары, налоги и раскидает по категориям с помощью Gemini Flash 3.",

        f2_title: "Голосовой ввод",
        f2_desc: "За рулем? Просто скажите: \"Я купил материалы на две тысячи\". Идеально распознает и структурирует любой язык в реальном времени.",

        f3_title: "Life & Calendar",
        f3_desc: "Трекайте настроение, задачи и встречи в Google Calendar. Получайте проактивные утренние сводки через Telegram.",

        f4_title: "Мульти-агентная аналитика",
        f4_desc: "Запрашивайте сложные отчеты: \"Покажи мои траты на авто за полгода по месяцам\". Claude 3.5 Sonnet генерирует точные графики прямо в чат.",

        uc_badge: "USE CASES",
        uc_title: "Создан под <span class='gradient-text'>вашу</span> жизнь",

        uc1_title: "Для малого бизнеса и фриланса",
        uc1_desc: "Бот запоминает категории ваших расходов (Материалы, Реклама, Подрядчики). Фотографируйте накладные, чтобы ничего не забыть для налоговой, и ведите CRM-контакты клиентов.",
        tag_invoice: "Инвойсы",
        tag_taxes: "Налоги",

        uc2_title: "Совместный семейный бюджет",
        uc2_desc: "Подключите супругов к одному семейному аккаунту в Telegram. Каждый вносит свои траты, а владелец видит полную картину с разделением доступов.",
        tag_sync: "Синхронизация",
        tag_list: "Списки покупок",

        uc3_title: "Для таксистов и дальнобойщиков",
        uc3_desc: "Записывайте топливо, ремонт и сборы на ходу с помощью голосовых команд. Получайте сводки для IFTA-отчетов без отрыва от руля.",
        tag_voice: "Голос",

        pricing_title: "Готовы делегировать хаос <span class='gradient-text'>ИИ</span>?",
        pricing_subtitle: "Стройте свои финансы как код. Без скачивания лишних приложений.",
        pricing_period: "/месяц",
        pricing_desc: "Полный доступ ко всем модулям AI, распознаванию чеков, интеграции с календарем и приоритетная поддержка.",
        pricing_btn: "Перейти в Telegram",

        footer_copy: "© 2026 Finance Bot. Все права защищены.",
        footer_prod: "Продукт",
        footer_int: "Интеграции",
        footer_res: "Ресурсы",
        footer_sup: "Поддержка",
        footer_comp: "Компания",
        footer_about: "О нас",
        footer_priv: "Политика конфиденциальности",
        footer_terms: "Условия использования",

        term_input: "\"Заправил трак на 150 баксов\"",
        term_processing: "Processing with Finance AI...",
        term_cat: "Транспорт / Топливо",
        term_note: "Note: Записано в расходы. Это 15% от бюджета на месяц.",
        code_query: "\"Авто за полгода\""
    },
    en: {
        nav_features: "Features",
        nav_how: "How it works",
        nav_pricing: "Pricing",
        nav_docs: "Documentation",
        nav_blog: "Blog",
        nav_login: "Login",
        nav_start: "Start for free",

        hero_badge: "Powered by Claude 3.5 & Gemini Flash",
        hero_title: "Your personal <br><span class='gradient-text type-effect'>financial AI assistant</span>",
        hero_subtitle: "Manage money, tasks, and schedules right in your favorite messenger. Ideal for small businesses, freelancers, and families.",
        hero_btn_start: "Start Using",
        hero_btn_docs: "Read Docs",

        integrations_label: "INTEGRATES WITH YOUR FAVORITE TOOLS",

        features_badge: "FULL CONTROL",
        features_title: "Everything you need. <br>In <span class='gradient-text'>one</span> chat.",
        features_subtitle: "Forget complex spreadsheets and dozens of apps. Just send a command or a photo.",

        f1_title: "Smart Receipt OCR",
        f1_desc: "Smart data extraction. Send a photo of a crumpled receipt. AI instantly recognizes merchant, items, taxes, and categorizes them using Gemini Flash 3.",

        f2_title: "Voice Input",
        f2_desc: "Driving? Just say: \"I bought materials for two thousand.\" Perfectly recognizes and structures any language in real time.",

        f3_title: "Life & Calendar",
        f3_desc: "Track mood, tasks, and meetings in Google Calendar. Get proactive morning summaries via Telegram.",

        f4_title: "Multi-agent Analytics",
        f4_desc: "Request complex reports: \"Show my car expenses for half a year by months.\" Claude 3.5 Sonnet generates accurate charts right in the chat.",

        uc_badge: "USE CASES",
        uc_title: "Built for <span class='gradient-text'>your</span> life",

        uc1_title: "For small business and freelancers",
        uc1_desc: "The bot remembers your expense categories (Materials, Ads, Contractors). Snap invoices so you don't forget anything for taxes, and keep CRM client contacts.",
        tag_invoice: "Invoices",
        tag_taxes: "Taxes",

        uc2_title: "Shared Family Budget",
        uc2_desc: "Connect spouses to one family account in Telegram. Everyone enters their spending, and the owner sees the full picture with separated access.",
        tag_sync: "Sync",
        tag_list: "Shopping lists",

        uc3_title: "For truckers and drivers",
        uc3_desc: "Record fuel, repairs, and tolls on the go using voice commands. Get summaries for IFTA reports without taking your hands off the wheel.",
        tag_voice: "Voice",

        pricing_title: "Ready to delegate chaos to <span class='gradient-text'>AI</span>?",
        pricing_subtitle: "Build your finances like code. Without downloading unnecessary apps.",
        pricing_period: "/month",
        pricing_desc: "Full access to all AI modules, receipt recognition, calendar integration, and priority support.",
        pricing_btn: "Go to Telegram",

        footer_copy: "© 2026 Finance Bot. All rights reserved.",
        footer_prod: "Product",
        footer_int: "Integrations",
        footer_res: "Resources",
        footer_sup: "Support",
        footer_comp: "Company",
        footer_about: "About Us",
        footer_priv: "Privacy Policy",
        footer_terms: "Terms of Service",

        term_input: "\"Refueled the truck for 150 bucks\"",
        term_processing: "Processing with Finance AI...",
        term_cat: "Transport / Fuel",
        term_note: "Note: Recorded as expense. This is 15% of your monthly budget.",
        code_query: "\"Auto for half a year\""
    },
    es: {
        nav_features: "Características",
        nav_how: "Cómo funciona",
        nav_pricing: "Precios",
        nav_docs: "Documentación",
        nav_blog: "Blog",
        nav_login: "Iniciar sesión",
        nav_start: "Empezar gratis",

        hero_badge: "Impulsado por Claude 3.5 y Gemini Flash",
        hero_title: "Tu asistente <br><span class='gradient-text type-effect'>financiero IA</span> personal",
        hero_subtitle: "Gestiona dinero, tareas y horarios directamente en tu mensajero favorito. Ideal para pequeñas empresas, autónomos y familias.",
        hero_btn_start: "Empezar a Usar",
        hero_btn_docs: "Leer Documentación",

        integrations_label: "SE INTEGRA CON TUS HERRAMIENTAS FAVORITAS",

        features_badge: "CONTROL TOTAL",
        features_title: "Todo lo que necesitas. <br>En <span class='gradient-text'>un</span> solo chat.",
        features_subtitle: "Olvídate de hojas de cálculo complejas y decenas de aplicaciones. Solo envía un comando o una foto.",

        f1_title: "OCR de Recibos Inteligente",
        f1_desc: "Extracción inteligente de datos. Envía una foto de un recibo. La IA reconoce instantáneamente al comerciante, los artículos, los impuestos y los categoriza.",

        f2_title: "Entrada de Voz",
        f2_desc: "¿Conduciendo? Simplemente di: \"Compré materiales por dos mil\". Reconoce y estructura perfectamente cualquier idioma en tiempo real.",

        f3_title: "Vida y Calendario",
        f3_desc: "Haz un seguimiento del estado de ánimo, las tareas y las reuniones en Google Calendar. Recibe resúmenes matutinos proactivos a través de Telegram.",

        f4_title: "Analítica Multi-agente",
        f4_desc: "Solicita informes complejos: \"Muestra los gastos de mi coche durante medio año por meses\". Claude 3.5 Sonnet genera gráficos precisos en el chat.",

        uc_badge: "CASOS DE USO",
        uc_title: "Creado para <span class='gradient-text'>tu</span> vida",

        uc1_title: "Para pequeñas empresas y autónomos",
        uc1_desc: "El bot recuerda tus categorías de gastos. Toma fotos de facturas para no olvidar nada para los impuestos y mantén los contactos de clientes del CRM.",
        tag_invoice: "Facturas",
        tag_taxes: "Impuestos",

        uc2_title: "Presupuesto Familiar Compartido",
        uc2_desc: "Conecta a los cónyuges a una cuenta familiar en Telegram. Todos introducen sus gastos y el propietario ve el panorama completo con acceso separado.",
        tag_sync: "Sincronización",
        tag_list: "Listas de compras",

        uc3_title: "Para camioneros y conductores",
        uc3_desc: "Registra combustible, reparaciones y peajes sobre la marcha mediante comandos de voz. Obtén resúmenes para informes IFTA sin quitar las manos del volante.",
        tag_voice: "Voz",

        pricing_title: "¿Listo para delegar el caos a <span class='gradient-text'>la IA</span>?",
        pricing_subtitle: "Construye tus finanzas como código. Sin descargar aplicaciones innecesarias.",
        pricing_period: "/mes",
        pricing_desc: "Acceso completo a todos los módulos de IA, reconocimiento de recibos, integración de calendario y soporte prioritario.",
        pricing_btn: "Ir a Telegram",

        footer_copy: "© 2026 Finance Bot. Todos los derechos reservados.",
        footer_prod: "Producto",
        footer_int: "Integraciones",
        footer_res: "Recursos",
        footer_sup: "Soporte",
        footer_comp: "Compañía",
        footer_about: "Sobre nosotros",
        footer_priv: "Política de Privacidad",
        footer_terms: "Términos de Servicio",

        term_input: "\"Reposté el camión por 150 dólares\"",
        term_processing: "Procesando con Finance AI...",
        term_cat: "Transporte / Combustible",
        term_note: "Nota: Registrado como gasto. Esto es un 15% de tu presupuesto mensual.",
        code_query: "\"Auto de medio año\""
    }
};

document.addEventListener('DOMContentLoaded', () => {

    /* --- Multi-language Support --- */
    const languageSelect = document.getElementById('language-select');

    function setLanguage(lang) {
        document.documentElement.lang = lang;
        const elementsInfo = document.querySelectorAll('[data-i18n]');
        const elementsId = ['term_input', 'term_processing', 'term_cat', 'term_note', 'code_query'];

        // Update tags
        elementsInfo.forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[lang][key]) {
                el.innerHTML = translations[lang][key];
            }
        });

        // Update Terminal Elements
        elementsId.forEach(id => {
            const el = document.getElementById(id);
            if (el && translations[lang][id]) {
                el.innerText = translations[lang][id];
            }
        });

        // Retrigger typewriter if needed (reset hero title)
        triggerTypewriter();
    }

    if (languageSelect) {
        languageSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });
    }

    /* --- Navbar Scroll Effect --- */
    const navbar = document.querySelector('.navbar');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 20) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    });

    /* --- Scroll Reveal Animations --- */
    const revealElements = document.querySelectorAll('.reveal');

    const revealOptions = {
        threshold: 0.05,
        rootMargin: "0px 0px -20px 0px"
    };

    const revealOnScroll = new IntersectionObserver(function (entries, observer) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
                observer.unobserve(entry.target);
            }
        });
    }, revealOptions);

    revealElements.forEach(el => {
        revealOnScroll.observe(el);
    });

    // Trigger for elements already in viewport
    setTimeout(() => {
        revealElements.forEach(el => {
            const rect = el.getBoundingClientRect();
            if (rect.top < window.innerHeight && rect.bottom > 0) {
                el.classList.add('active');
            }
        });
    }, 100);

    /* --- Composio-style Mouse Hover Glow --- */
    const cards = document.querySelectorAll('.hover-glow');

    document.addEventListener('mousemove', e => {
        for (const card of cards) {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            card.style.setProperty('--mouse-x', `${x}px`);
            card.style.setProperty('--mouse-y', `${y}px`);

            // Set custom glow color if data attribute exists
            const glowColor = card.getAttribute('data-glow-color');
            if (glowColor) {
                card.style.setProperty('--mouse-color', glowColor);
            }
        }
    });

    /* --- Terminal Sequence Animation --- */
    function runTerminalDemo() {
        const cmdResp1 = document.getElementById('cmd-resp-1');
        const cmdResp2 = document.getElementById('cmd-resp-2');

        if (!cmdResp1 || !cmdResp2) return;

        // Sequence timing
        setTimeout(() => {
            cmdResp1.classList.remove('hidden');
        }, 1200);

        setTimeout(() => {
            const currentLang = languageSelect ? languageSelect.value : 'ru';
            cmdResp1.querySelector('.clr-dim').textContent = (currentLang === 'en' ? "Processing ✓" : (currentLang === 'es' ? "Procesando ✓" : "Обработка ✓"));
            cmdResp2.classList.remove('hidden');
        }, 3000);
    }

    /* --- Typewriter Effect for Hero --- */
    let typewriterTimeout;
    function triggerTypewriter() {
        const typeTextList = document.querySelectorAll('.type-effect');
        if (typeTextList.length > 0) {
            const typeText = typeTextList[0];
            const textToType = typeText.textContent;
            typeText.textContent = '';
            let i = 0;
            clearTimeout(typewriterTimeout);

            function typeWriter() {
                if (i < textToType.length) {
                    typeText.textContent += textToType.charAt(i);
                    i++;
                    typewriterTimeout = setTimeout(typeWriter, 30);
                } else {
                    runTerminalDemo();
                }
            }
            typeWriter();
        } else {
            runTerminalDemo();
        }
    }

    triggerTypewriter();

    /* --- Infinite Marquee Cloning --- */
    const marqueeContent = document.querySelector('.marquee-content');
    if (marqueeContent && !marqueeContent.classList.contains('cloned')) {
        // Clone items for smooth infinite scroll
        const clone = marqueeContent.innerHTML;
        marqueeContent.innerHTML += clone + clone;
        marqueeContent.classList.add('cloned');

        // Simple GSAP-less marquee animation using Web Animations API
        const scrollWidth = marqueeContent.scrollWidth / 3;

        marqueeContent.animate([
            { transform: 'translateX(0)' },
            { transform: `translateX(-${scrollWidth}px)` }
        ], {
            duration: 20000,
            iterations: Infinity,
            easing: 'linear'
        });
    }

});
